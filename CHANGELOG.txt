CHANGELOG

### v2.0 - Forensic Toolkit & UI Enhancements
- **Feature:** Added **Dark/Light Theme Toggle** with localStorage persistence. Click the moon/sun icon to switch themes.
- **Feature:** Added **Regex Search in Results** - filter query results using regex patterns with quick-pattern buttons for Email, IP, URL, and Phone.
- **Feature:** Added **Multi-Column Sorting** - hold Shift while clicking column headers to sort by multiple columns.
- **Feature:** Added **Search All Tables** - full-text search across all database tables with case sensitivity toggle and compact grouped output.
- **Feature:** Added **CSV Export** for query results with metadata headers (timestamp, row count, SQL query).
- **Feature:** Added **12 Custom SQL Functions** for forensic analysis:
  - Timestamp converters: `unix_to_datetime()`, `webkit_to_datetime()`, `ios_to_datetime()`, `filetime_to_datetime()`
  - Encode/decode: `encode_base64()`, `decode_base64()`, `to_hex()`, `decode_hex()`
  - Pattern extractors: `extract_email()`, `extract_ip()`, `extract_url()`, `extract_phone()`
- **Feature:** Added **Browser Warning** when leaving page with active chat session to prevent accidental data loss.
- **UX:** Grid.js tables now respect theme colors (dark/light mode aware).
- **Security:** SQL validation now allows queries with leading comments (-- style).
- **AI:** Updated LLM system prompt to document custom SQL functions and guide proper UNION ALL usage.

### v1.7 - SQL Capabilities Expansion & Defense-in-Depth Security
- **Feature:** SQL validation now supports **CTEs (WITH clauses)** for complex analytical queries.
- **Feature:** Added support for **EXPLAIN** and **EXPLAIN QUERY PLAN** for query performance analysis.
- **Feature:** Added support for read-only **PRAGMA** commands (table_info, foreign_key_list, integrity_check, etc.) for schema inspection.
- **Security:** Implemented **database-level read-only enforcement** - connections now opened in SQLite `mode=ro` with `PRAGMA query_only = ON` for defense-in-depth protection.
- **Security:** Expanded SQL keyword blocklist from 9 to 13 keywords, added PRAGMA-specific safety checks.
- **AI/UX:** Fixed LLM system prompt to execute simple queries immediately instead of asking for confirmation on unambiguous requests.
- **AI/UX:** Improved clarity in prompt - LLM now only asks clarifying questions for genuinely ambiguous requests.
- **Testing:** Added comprehensive validation test suite (15 test cases) covering safe query patterns and security blocking.

### v1.6 - Interactive Tables, Annotations & Shortcuts
- **Feature:** Added **Smart Data Tables** (via Grid.js) for SQL results, featuring sortable columns, search/filter, and pagination.
- **Feature:** Added **Forensic Annotations** allowing analysts to attach persistent notes to any assistant response. Notes are preserved in chat exports.
- **UX:** Implemented **Syntax Highlighting** for SQL code blocks in chat responses.
- **UX:** Significant UI polish including dark-themed interactive elements and improved visibility for inputs/pagination.
- **Tech:** Replaced simple HTML tables with interactive Grid.js components.
- **Tech:** Added `uuid` based message tracking to support persistent annotations.

### v1.5 - UI/UX Overhaul & Drag-and-Drop
- **Feature:** Implemented a dedicated drag-and-drop zone for database uploads, replacing the basic file input.
- **UX:** Added a persistent, minimized welcome screen that stays at the top of the chat history for better branding and visual continuity.
- **UX:** Fixed the "empty message bubble" glitch that appeared after file uploads.
- **Visuals:** Refined the welcome screen transition animations and solved ASCII art clipping issues in the minimized state.

### v1.4 - Forensic Hardening & Security
- **Feature:** Added SHA256 hashing for all uploaded evidence files.
- **Feature:** Implemented comprehensive audit logging (`logs/`) with daily rotation.
- **Feature:** Enhanced "Export Chat" with professional forensic report header (Hash, timestamps, analyst info).
- **Feature:** Added support for importing `.csv` (auto-converted to SQLite) and `.sql` dump files.
- **AI Persona:** Refined LLM system prompt to act as a "Forensics Assistant" with Chain-of-Thought reasoning.
- **AI Stability:** Fixed context drift by pinning schema to system prompt.
- **Robustness:** Added backend timeouts (60s) and frontend watchdog (15s) to prevent "infinite spinner" hangs.
- **Security:** Added strict file validation (extension, magic bytes, size limits).
- **Security:** Implemented global error handling for 404/500 events.
- **UX:** Added client-side file size warnings (>100MB) and blocking (>1GB).
- **UX:** Added smart troubleshooting guide for LLM connection failures.

### v1.2 - Token Usage Tracking
- **Feature:** Display token usage in top-right of LLM chat bubbles showing per-message and cumulative totals.
- **Details:** Hover over token counter to see prompt/completion breakdown.
- **Backend:** Captures token usage from LM Studio API (v0.3.18+) via stream_options parameter.
- **Session:** Token data persists in session and is included in HTML exports.
- **Compatibility:** Graceful degradation for older LM Studio versions - no errors if token data unavailable.

### v1.1 - UI/UX Polish & Robustness
- **UI:** Fixed "double scrollbar" issues and optimized layout for windowed modes.
- **Safety:** Added confirmation dialogs when uploading a new database during an active chat.
- **Export:** Enhanced chat export to perfectly mirror the application's visual style and layout.
- **Fix:** Resolved event listener conflicts preventing double-submission on upload.
